<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tabella - Programmi</title>
  <link rel="icon" type="image/png" href="Immagini/plumboblogo.png">
  <style>
    :root {
          --navbarbackground: #343a40;
          --navbarcolor: #fff;
          --formcontainerbackground: #343a40;
          --formcontainercolor: #fff;
          --h1backgroundcolor: #343a40;
          --h1color: white;
          --thchildcolor: #666666;
          --tdcolor: #555555;
          --thcolor: white;
          --bodybackground: #343a40;
          --sconosciutavar: #545454;
          --thtdcolor: white;
          --tdacolor: #B57EDC;
          --tdahover: #FFB6C1;
          --tdactive: #8E44AD; 
          --text-color: #fff;
        }
    
        #filter-status-dropdown, #filter-translation-dropdown, #filter-category-dropdown {
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    td a {
  color: var(--tdacolor);
}

td a:visited {
  color: var(--tdacolor);
}

td a:hover {
  color: var(--tdahover);
}

td a:active {
  color: var(--tdactive);
}
.language-toggle {
  position: absolute;
  top: 20px;
  right: 20px; /* Spostato in alto a destra */
  display: flex;
  align-items: center;
  gap: 10px;
  color: var(--text-color)
}
.switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 24px;
    }

    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: 0.4s;
      border-radius: 24px;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 20px;
      width: 20px;
      left: 2px;
      bottom: 2px;
      background-color: white;
      transition: 0.4s;
      border-radius: 50%;
    }

    input:checked + .slider {
      background-color: #16ab63;
    }

    input:checked + .slider:before {
      transform: translateX(26px);
    }
        .navbar {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-around;
      align-items: center;
      background-color: var(--navbarbackground);
      padding: 10px;
      border-bottom: 3px solid #f9359d; /* Bordo inferiore della navbar */
    }
    
    .navbar a, .navbar button {
      color: var(--navbarcolor);
      text-decoration: none;
      background-color: #4CAF50; /* Usa il colore di sfondo dal nuovo design */
      padding: 10px 20px; /* Pi√π spazio cliccabile */
      border-radius: 5px; /* Raggio bordi pi√π ampio */
      border: none;
      margin: 5px;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.2s ease;
      font-size: 16px; /* Font pi√π grande */
      text-align: center; /* Per centrare il testo */
      font-weight: bold;
    }
    
    .navbar a:hover, .navbar button:hover {
      background-color: #0f7041; /* Colore hover pi√π intenso */
      transform: scale(1.05); /* Leggero ingrandimento al passaggio del mouse */
    }
.sort-arrow {
  margin-left: 5px;
  font-size: 20px;
  color: var(--h1color);
}
    
    .sort-arrow.asc:before {
      content: "‚Üë"; /* Freccia su per l'ordinamento ascendente */
    }
    
    .sort-arrow.desc:before {
      content: "‚Üì"; /* Freccia gi√π per l'ordinamento discendente */
    }
          .scroll-to-top {
      position: fixed;
      bottom: 20px;
      right: 20px;
      display: none; /* Sar√† visibile solo quando necessario */
      width: 50px;
      height: 50px;
      background-color: #f05454;
      color: white;
      text-align: center;
      line-height: 50px;
      font-size: 24px;
      font-weight: bold;
      border-radius: 50%;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      cursor: pointer;
      transition: opacity 0.3s, transform 0.3s;
      z-index: 1000;
    }
    
    .scroll-to-top:hover {
      background-color: #d94343; /* Colore pi√π scuro al passaggio del mouse */
      transform: scale(1.1); /* Leggera animazione di ingrandimento */
    }
    
    .scroll-to-top:active {
      transform: scale(0.95); /* Riduce leggermente le dimensioni al clic */
    }
       .back-arrow {
      position: absolute;
      top: 10px;
      left: 10px;
      text-decoration: none;
      font-size: 20px;
      color: #16ab63;
      font-weight: bold;
      transition: color 0.3s ease, transform 0.2s ease;
      display: flex;
  align-items: center;
  text-decoration: none;
    }

    .back-arrow:hover {
      color: #16ab63;
      transform: scale(1.1);
    }
          
        body {
          font-family: Arial, sans-serif;
          background-color: var(--bodybackground);
          margin: 0;
          padding: 0;
        }
        
        input, select {
          margin: 10px 5px;
          padding: 10px;
          border-radius: 25px;
          border: 1px solid #ccc;
          font-size: 16px;
        }
    
        input:focus, select:focus {
          outline: none;
          border-color: #16ab63;
        }
    
        .form-container {
          display: flex;
          flex-wrap: wrap;
          justify-content: flex-start;
          align-items: center;
          margin-top: 0px; /* Riduci lo spazio sopra */
          margin-bottom: 0px; /* Riduci lo spazio sotto */
          padding: 5px;
          border: 1px solid var(--formcontainerbackground);
          border-radius: 5px;
          background-color: var(--formcontainerbackground);
          color: var(--formcontainercolor);
          gap: 60px;
        }
    
        .form-container label {
          margin-right: 10px;
          font-size: 16px;
        }
    
        input, select {
          margin: 5px;
        }
    
        .button-container {
          display: flex;
          flex-wrap: wrap;
          justify-content: center;
          gap: 10px;
        }
    
        h1 {
          color: var(--h1color);
          font-size: 2rem;
          margin: 0;
          padding: 20px 0;
          background-color: var(--h1backgroundcolor);
          text-align: center;
        }
    
        table {
          width: 100%;
          border-collapse: separate;
          border-spacing: 0;
          margin-top: 20px;
          border-radius: 10px;
          overflow: hidden;
          table-layout: auto;
        }
    
        th, td {
          padding: 15px 20px;
          text-align: center;
          border: 1px solid #ddd;
          font-size: 16px;
          word-wrap: break-word;
          color: var(--thtdcolor)
        }
    
        th {
          background-color: #4CAF50;
          color: var(--thcolor);
        }
    
        td {
          background-color: var(--tdcolor);
        }
    
        tr:nth-child(even) td {
          background-color: var(--thchildcolor);
        }
    
        .status {
          font-weight: bold;
          padding: 5px;
          border-radius: 5px;
          display: inline-block;
          width: auto;
          height: auto;
          text-transform: uppercase;
          color: white;
        }
          
        .status.nuovo {
          color: #9372ff;
        }
          
        .status.compatibile {
          color: #008eff;
        }
    
        .status.rotto {
          color: #ff0015;
        }
        
        .status.sconosciuto {
          color: var(--sconosciutavar);
        }
    
        .status.non-disponibile {
          color: var(--sconosciutavar);
          text-transform: uppercase;
        }
    
        .status.aggiornato {
          color: #00d517;
        }
     /* Stile per il popup */
     .popup {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: var(--navbarbackground);
    color: var(--navbarcolor);
    padding: 20px;
    box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.3);
    border-radius: 10px;
    z-index: 1000;
    text-align: center;
}

.popup-content button {
    margin: 10px;
    padding: 10px;
    border: none;
    cursor: pointer;
}

#download-btn {
    background: #28a745;
    color: white;
}

#close-btn {
    background: #dc3545;
    color: white;
}  
        @media (max-width: 600px) {
          h1 {
            font-size: 1.5rem;
            padding: 10px;
          }
    
          .navbar a, .navbar button {
            font-size: 14px;
            padding: 10px;
            width: 100%;
          }
    
          .form-container {
            flex-direction: column;
            align-items: flex-start;
          }
        }
    
        .star-container {
          display: flex;
          justify-content: center;
          align-items: center;
          width: 100%;
          height: 100%;
        }
    
        .star {
          font-size: 24px;
          cursor: pointer;
          color: grey;
          transition: transform 0.2s;
        }
    
        .star.favorite {
          color: gold;
        }
    
        .star:hover {
          transform: scale(1.2);
        }
      </style>
</head>
<body>
  <a href="index.html" class="back-arrow">
    <img src="Immagini/plumboblogonoscritte.png" alt="Home Logo" width="50" height="auto">
    <span class="home-text">HOME</span>
  </a>
  <h1 id="page-title">Tabella - Programmi</h1>
  <div class="navbar">
    <a href="mod.html" id="mod-link">MOD</a>
    <a href="mod18.html" id="mod18-link">MOD +18</a>
    <a href="animazioniww18.html" id="animazioniww18-link">ANIMAZIONI WICKEDWHIMS +18</a>
    <a href="traduzioni.html" id="traduzioni-link">TRADUZIONI</a>
    <a href="programmi.html" id="programmi-link">PROGRAMMI</a>
    <a href="#" id="desc-mod-btn">HELP SIM</a>
    <button id="themeSwitch" onclick="toggleTheme()" class="theme-toggle" title="Cambia Tema">üåô</button>
  </div>
  <div class="language-toggle">
    <label class="switch">
      <input type="checkbox" id="language-switch">
      <span class="slider"></span>
    </label>
    <span id="language-label">Italiano</span>
  </div>
  <div id="popup" class="popup">
    <div class="popup-content">
        <h2>üöÄ HELP SIM</h2>
        <p>
          Stanco di installare mod e traduzioni a mano? Help Sim √® qui per salvarti! 
          Con pochi click, potrai aggiungere le tue mod preferite, tenere tutto sotto controllo e persino dare una bella ripulita ai file cache di The Sims 4!
          Che tu voglia ampliare il tuo gioco con nuove mod o semplicemente tenere tutto in ordine, sei nel posto giusto.
        </p>
        
        <p>Ora rilassati, personalizza il tuo gioco e lascia che <strong>Help Sim</strong> faccia il resto! üéÆ‚ú®</p>
        
        <hr>
  
        <h3>‚ö†Ô∏è PICCOLE ATTENZIONI PRIMA DELLO SCARICO ‚ö†Ô∏è</h3>
        <ul style="list-style-type: none; padding-left: 0;">
            <li>‚òÖ Se l‚Äôantivirus blocca il programma, clicca su <strong>"Esegui comunque"</strong>.<br>
                Il programma √® sicuro! In quanto creato interamente da noi.</li>
            <li>‚òÖ Prima dell‚Äôuso, <strong>leggi la guida</strong> disponibile nella home del programma.</li>
            <li>‚òÖ Supporta solo i file delle mod e delle traduzioni in <strong>formato ZIP</strong>.</li>
            <li>‚òÖ <strong>Non supporta</strong> i file singoli <em>.package</em> (CC e mod non zip).</li>
            <li>‚òÖ <strong>Non funziona</strong> con la cartella di The Sims in unit√† esterne (HDD, SSD, USB, ecc.).</li>
        </ul>
  
        <div class="popup-buttons">
            <button id="download-btn">üì• Scarica</button>
            <button id="close-btn">‚ùå Chiudi</button>
        </div>
    </div>
  </div>
  <div class="form-container">
    <div>
      <input type="text" id="search" oninput="filterTable()" placeholder="Cerca...">
    </div>
    <div>
      <label for="filter-status" id="filter-status-label">Stato:</label>
      <button onclick="toggleDropdown('filter-status-dropdown')">‚ñº</button>
      <div id="filter-status-dropdown" style="display:none;">
        <label><input type="checkbox" value="Compatibile" id="status-compatibile" onchange="filterTable()"> Compatibile</label><br>
        <label><input type="checkbox" value="Rotto" id="status-rotto" onchange="filterTable()"> Rotto</label><br>
        <label><input type="checkbox" value="Aggiornato" id="status-aggiornato" onchange="filterTable()"> Aggiornato</label><br>
        <label><input type="checkbox" value="Sconosciuto" id="status-sconosciuto" onchange="filterTable()"> Sconosciuto</label><br>
        <label><input type="checkbox" value="Non Disponibile" id="status-non-disponibile" onchange="filterTable()"> Non Disponibile</label><br>
        <label><input type="checkbox" value="Nuova" id="status-nuovo" onchange="filterTable()"> Nuovo</label>

      </div>
    </div>
    <div>
      <label for="filter-favorites" id="filter-favorites-label">Preferiti:</label>
      <select id="filter-favorites" onchange="filterTable()">
        <option value="">Tutti</option>
        <option value="true">Preferiti</option>
        <option value="false">Non Preferiti</option>
      </select>
    </div>
</div>
<table id="programmi-table">
  <thead>
      <tr>
        <th rowspan="2" onclick="sortTable(0)">PREFERITI <span class="sort-arrow" id="arrow-0"></span></th>
        <th rowspan="2" onclick="sortTable(1)">PROGRAMMA <span class="sort-arrow" id="arrow-1"></span></th>
        <th colspan="2" onclick="sortTable(2)">SISTEMA OPERATIVO <span class="sort-arrow" id="arrow-2"></span></th>
        <th colspan="2" onclick="sortTable(3)">STATO PROGRAMMA <span class="sort-arrow" id="arrow-3"></span></th>
        <th colspan="2" onclick="sortTable(4)">LINK PROGRAMMA <span class="sort-arrow" id="arrow-4"></span></th>
        <th colspan="2" onclick="sortTable(4)">DATA AGGIORNAMENTO <span class="sort-arrow" id="arrow-4"></span></th>
        <th rowspan="2" onclick="sortTable(6)">VIDEO SPIEGATIVO <span class="sort-arrow" id="arrow-6"></span></th>
        
      </tr>
      <tr>
          <!-- La seconda riga rimane vuota per le celle che sono gi√† unite nella prima -->
          <th>Windows</th> <!-- Header for Windows -->
          <th>macOS</th> <!-- Header for macOS -->
          <th>Windows</th> <!-- Stato per Windows -->
          <th>macOS</th> <!-- Stato per macOS -->
          <th>Windows</th> <!-- Stato per Windows -->
          <th>macOS</th> <!-- Stato per macOS -->
          <th>Windows</th> <!-- Stato per Windows -->
          <th>macOS</th> <!-- Stato per macOS -->
      </tr>
  </thead>
  <tbody>
      <!-- Le righe verranno caricate dinamicamente dal JSON -->
  </tbody>
</table>
  <script>
        document.getElementById("desc-mod-btn").addEventListener("click", function(event) {
    event.preventDefault();
    document.getElementById("popup").style.display = "block";
});

document.getElementById("close-btn").addEventListener("click", function() {
    document.getElementById("popup").style.display = "none";
});

document.getElementById("download-btn").addEventListener("click", function() {
    const link = document.createElement("a");
    link.href = "https://github.com/PianetaSimTS/HelpSim/releases/download/HelpSim/HelpSim.exe";
    link.download = "HelpSim.exe";
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    document.getElementById("popup").style.display = "none"; // Chiude il popup dopo il download
});
function loadModsFromJson() {
  fetch('https://raw.githubusercontent.com/PianetaSimTS/PianetaSim/refs/heads/main/Json/programmi.json')
    .then(response => response.json())
    .then(mods => {
      const favorites = JSON.parse(localStorage.getItem("favorites")) || [];
      const table = document.getElementById("programmi-table").getElementsByTagName("tbody")[0];
      table.innerHTML = '';

      // Crea righe per ogni mod
      mods.forEach(mod => {
        const isFavorite = favorites.includes(mod.programma);
        const checkWindows = mod.windows ? '‚úî' : '‚ùå';
        const checkMacOS = mod.macOS ? '‚úî' : '‚ùå';

        // Gestisci la logica per status
        let statusWindows = mod.statuswindows || 'Sconosciuto';
        let statusMacOS = mod.statusmacos || 'Sconosciuto';

        // Gestisci la logica per data aggiornamento
        let dataAggiornamentoWindows = mod.data_aggiornamentowindows || '';
        let dataAggiornamentoMacOS = mod.data_aggiornamentomacos || '';

        // Sostituisci 'NON-DISPONIBILE' o 'non-disponibile' con 'NON DISPONIBILE'
        if (statusWindows.toLowerCase() === 'non-disponibile') {
          statusWindows = 'NON DISPONIBILE';
        }
        if (statusMacOS.toLowerCase() === 'non-disponibile') {
          statusMacOS = 'NON DISPONIBILE';
        }

        // Crea le righe della tabella
        const newRow = table.insertRow();
        newRow.innerHTML = `
  <td>
    <span class="star-container">
      <span class="star ${isFavorite ? 'favorite' : ''}" onclick="toggleFavorite('${mod.programma}')">&#9733;</span>
    </span>
  </td>
  <td>${mod.programma || ''}</td>
  <td>${checkWindows}</td> <!-- Compatibilit√† con Windows -->
  <td>${checkMacOS}</td> <!-- Compatibilit√† con macOS -->
  <td><span class="status windows ${statusWindows.toLowerCase().replace(/\s+/g, '-')}"">${statusWindows}</span></td> <!-- Stato Windows -->
  <td><span class="status macOS ${statusMacOS.toLowerCase().replace(/\s+/g, '-')}"">${statusMacOS}</span></td> <!-- Stato macOS -->
  <td><a href="${mod.link_programmawindows || '#'}" target="_blank">Link</a></td>
  <td>${mod.link_programmamacos ? `<a href="${mod.link_programmamacos}" target="_blank">Link</a>` : ''}</td> <!-- Link MacOS se disponibile -->
  <td>${dataAggiornamentoWindows || ''}</td>
  <td>${dataAggiornamentoMacOS || ''}</td>
  <td><a href="${mod.video_spiegativo || '#'}" target="_blank">Video</a></td>`;
      });

      filterTable();
    })
    .catch(error => console.error('Errore nel caricare il JSON:', error));
}


let lastSortedColumn = -1; // Memorizza l'ultima colonna ordinata
let lastSortDirection = 'asc'; // Ordine di ordinamento: ascendente (default) o discendente

function sortTable(columnIndex) {
  const table = document.getElementById("programmi-table");
  const rows = Array.from(table.rows).slice(2); // Esclude l'intestazione e la seconda riga
  const arrow = document.getElementById(`arrow-${columnIndex}`);

  // Determina la direzione di ordinamento
  if (lastSortedColumn === columnIndex) {
    lastSortDirection = (lastSortDirection === 'asc') ? 'desc' : 'asc';
  } else {
    lastSortDirection = 'asc';
  }

  // Funzione di comparazione per ordinare i dati
  const compare = (a, b) => {
    let valA = a.cells[columnIndex].textContent.trim().toLowerCase();
    let valB = b.cells[columnIndex].textContent.trim().toLowerCase();

    // Gestione di valori "non disponibili" o altri casi speciali
    if (valA === 'non disponibile') valA = '';
    if (valB === 'non disponibile') valB = '';

    if (valA < valB) return lastSortDirection === 'asc' ? -1 : 1;
    if (valA > valB) return lastSortDirection === 'asc' ? 1 : -1;
    return 0;
  };

  // Ordinamento delle righe
  rows.sort(compare);
  rows.forEach(row => table.appendChild(row));

  // Modifica la direzione della freccia
  document.querySelectorAll('.sort-arrow').forEach(arrow => arrow.className = 'sort-arrow');
  arrow.classList.add(lastSortDirection);

  lastSortedColumn = columnIndex;
}

function filterTable() {
  const searchValue = document.getElementById("search").value.toLowerCase();

  // Stato - raccogli i valori selezionati (quindi solo "Rotto", "Aggiornato", ecc.)
  const selectedStatuses = Array.from(document.querySelectorAll('#filter-status-dropdown input:checked'))
                                  .map(input => input.value.toLowerCase());

  const filterFavorites = document.getElementById("filter-favorites").value.toLowerCase();

  const table = document.getElementById("programmi-table");
  const rows = table.getElementsByTagName("tr");

  for (let i = 1; i < rows.length; i++) {
    const row = rows[i];
    const programName = row.cells[1].textContent.toLowerCase();


    // Ottieni i dati per Windows e macOS
    const statusWindowsElement = row.querySelector(".status.windows");
const statusMacOSElement = row.querySelector(".status.macos");

const statusWindows = statusWindowsElement ? statusWindowsElement.textContent.toLowerCase() : '';
const statusMacOS = statusMacOSElement ? statusMacOSElement.textContent.toLowerCase() : '';

    // Controlla se uno dei due stati (Windows o macOS) corrisponde a uno dei selezionati
    const matchesWindowsStatus = selectedStatuses.length === 0 || selectedStatuses.some(status => statusWindows.includes(status));
    const matchesMacOSStatus = selectedStatuses.length === 0 || selectedStatuses.some(status => statusMacOS.includes(status));

    // Controllo se la riga corrisponde alla ricerca
    const matchesSearch = programName.includes(searchValue);

    // Verifica per i preferiti
    const starElement = row.querySelector(".star");
    const isFavorite = starElement && starElement.classList.contains("favorite");
    const matchesFavorites = !filterFavorites || (filterFavorites === 'true' ? isFavorite : !isFavorite);

    // Mostra o nascondi la riga in base ai filtri
    const shouldShowRow = matchesSearch && (matchesWindowsStatus || matchesMacOSStatus) && matchesFavorites;
    row.style.display = shouldShowRow ? "" : "none";
  }
}

    function toggleFavorite(author) {
  // Remove the apostrophe when toggling favorites
  const cleanedAuthor = author.replace("'", "");
  let favorites = JSON.parse(localStorage.getItem("favorites")) || [];
  
  if (favorites.includes(cleanedAuthor)) {
    favorites = favorites.filter(favorite => favorite !== cleanedAuthor);
    alert(author + " √® stato rimosso dai preferiti.");
  } else {
    favorites.push(cleanedAuthor);
    alert(author + " √® stato aggiunto ai preferiti!");
  }
  
  localStorage.setItem("favorites", JSON.stringify(favorites));
  loadModsFromJson();
}
    window.onload = loadModsFromJson;

    function applyTheme(theme) {
  const root = document.documentElement;
  const themeSwitch = document.getElementById("themeSwitch");
  
  if (theme === "light") {
    root.style.setProperty("--navbarbackground", "#ffffff"); // Grigio molto chiaro per la navbar
root.style.setProperty("--navbarcolor", "#000000"); // Testo scuro per la navbar
root.style.setProperty("--formcontainerbackground", "#ffffff"); // Bianco per lo sfondo del contenitore
root.style.setProperty("--formcontainercolor", "#black"); // Testo scuro nel contenitore
root.style.setProperty("--h1backgroundcolor", "#ffffff"); // Grigio chiaro per sfondo h1
root.style.setProperty("--h1color", "#black"); // Testo scuro per h1
root.style.setProperty("--thchildcolor", "#f2f2f2"); // Grigio medio per i titoli delle colonne
root.style.setProperty("--tdcolor", "#f9f9f9"); // Grigio medio-scuro per il testo nelle celle
root.style.setProperty("--thcolor", "#000000"); // Testo scuro per i titoli delle colonne
root.style.setProperty("--bodybackground", "#ffffff"); // Sfondo bianco per il corpo
root.style.setProperty("--sconosciutavar", "#545454"); // Giallo brillante per mantenere un colore vivace
root.style.setProperty("--thtdcolor", "black");
root.style.setProperty("--tdacolor", "blue");
root.style.setProperty("--tdahover", "#551A8B");
root.style.setProperty("--tdactive", "#000080");    
root.style.setProperty("--text-color", "#000");
    themeSwitch.textContent = "üåû";
  } else {
    // Passa al tema scuro
    root.style.setProperty("--navbarbackground", "#343a40");
    root.style.setProperty("--navbarcolor", "#fff");
    root.style.setProperty("--formcontainerbackground", "#343a40");
    root.style.setProperty("--formcontainercolor", "#fff");
    root.style.setProperty("--h1backgroundcolor", "#343a40");
    root.style.setProperty("--h1color", "white");
    root.style.setProperty("--thchildcolor", "#666666");
    root.style.setProperty("--tdcolor", "#555555");
    root.style.setProperty("--thcolor", "white");
    root.style.setProperty("--bodybackground", "#343a40");
    root.style.setProperty("--sconosciutavar", "#FFFBB9");
    root.style.setProperty("--thtdcolor", "white");
    root.style.setProperty("--tdacolor", "#B57EDC");
    root.style.setProperty("--tdahover", "#FFB6C1");
    root.style.setProperty("--tdactive", "#8E44AD");
    root.style.setProperty("--text-color", "#fff");
    themeSwitch.textContent = "üåô";
  }
}

const languageSwitch = document.getElementById("language-switch");
const languageLabel = document.getElementById("language-label");
const texts = {
  it: {
    helpSimTitle: "üöÄ HELP SIM",
    helpSimDesc: "Stanco di installare mod e traduzioni a mano? Help Sim √® qui per salvarti! Con pochi click, potrai aggiungere le tue mod preferite, tenere tutto sotto controllo e persino dare una bella ripulita ai file cache di The Sims 4! Che tu voglia ampliare il tuo gioco con nuove mod o semplicemente tenere tutto in ordine, sei nel posto giusto.",
    relax: "Ora rilassati, personalizza il tuo gioco e lascia che <strong>Help Sim</strong> faccia il resto! üéÆ‚ú®",
    precautions: "‚ö†Ô∏è PICCOLE ATTENZIONI PRIMA DELLO SCARICO ‚ö†Ô∏è",
    download: "üì• Scarica",
    close: "‚ùå Chiudi",
    pageTitle: "Tabella - Programmi",
    modLink: "MOD",
    mod18Link: "MOD +18",
    animazioniww18Link: "ANIMAZIONI WICKEDWHIMS +18",
    traduzioniLink: "TRADUZIONI",
    programmiLink: "PROGRAMMI",
    helpSimLink: "HELP SIM",
    searchPlaceholder: "Cerca...",
    filterStatusLabel: "Stato:",
    filterFavoritesLabel: "Preferiti:",
    tableHeaders: {
      favorites: "PREFERITI",
      programma: "PROGRAMMA",
      os: "SISTEMA OPERATIVO",
      statoprogramma: "STATO PROGRAMMA",
      linkprogramma: "LINK PROGRAMMA",
      dataaggiornamento: "DATA AGGIORNAMENTO",
      videospiegativo: "VIDEO SPIEGATIVO",
    }
  },
  en: {
    helpSimTitle: "üöÄ HELP SIM",
    helpSimDesc: "Tired of installing mods and translations manually? Help Sim is here to save you! With just a few clicks, you can add your favorite mods, keep everything under control and even give The Sims 4 cache files a good clean! Whether you want to expand your game with new mods or simply keep everything in order, you are in the right place.",
    relax: "Now relax, customize your game and let <strong>Help Sim</strong> do the rest! üéÆ‚ú®",
    precautions: "‚ö†Ô∏è SMALL PRECAUTIONS BEFORE DOWNLOADING ‚ö†Ô∏è",
    download: "üì• Download",
    close: "‚ùå Close",
    pageTitle: "Table - Programs",
    modLink: "MOD",
    mod18Link: "MOD +18",
    animazioniww18Link: "ANIMATIONS WICKEDWHIMS +18",
    traduzioniLink: "ITALIAN TRANSLATIONS",
    programmiLink: "PROGRAMS",
    helpSimLink: "HELP SIM",
    searchPlaceholder: "Search...",
    filterStatusLabel: "Status:",
    filterFavoritesLabel: "Favorites:",
    tableHeaders: {
      favorites: "FAVORITES",
      programma: "PROGRAM",
      os: "OPERATING SYSTEM",
      statoprogramma: "PROGRAM STATUS",
      linkprogramma: "PROGRAM LINK",
      dataaggiornamento: "UPDATE DATE",
      videospiegativo: "ITALIAN EXPLANATORY VIDEO",

    }
  }
};

// Funzione per cambiare lingua
function toggleLanguage() {
  const isEnglish = languageSwitch.checked;
  const lang = isEnglish ? "en" : "it";
  languageLabel.textContent = isEnglish ? "English" : "Italiano";
  localStorage.setItem("language", lang);

  // Aggiornamento dinamico dei testi
  document.querySelector("#popup h2").textContent = texts[lang].helpSimTitle;
  document.querySelector("#popup p").innerHTML = texts[lang].helpSimDesc;
  document.querySelector("#popup p:nth-of-type(2)").innerHTML = texts[lang].relax;
  document.querySelector("#popup h3").textContent = texts[lang].precautions;
  document.getElementById("download-btn").textContent = texts[lang].download;
  document.getElementById("close-btn").textContent = texts[lang].close;
  document.getElementById("page-title").textContent = texts[lang].pageTitle;
  document.getElementById("mod-link").textContent = texts[lang].modLink;
  document.getElementById("mod18-link").textContent = texts[lang].mod18Link;
  document.getElementById("animazioniww18-link").textContent = texts[lang].animazioniww18Link;
  document.getElementById("traduzioni-link").textContent = texts[lang].traduzioniLink;
  document.getElementById("programmi-link").textContent = texts[lang].programmiLink;
  document.getElementById("desc-mod-btn").textContent = texts[lang].helpSimLink;
  document.querySelector("#search").placeholder = texts[lang].searchPlaceholder;
  document.getElementById("filter-status-label").textContent = texts[lang].filterStatusLabel;
  document.getElementById("filter-favorites-label").textContent = texts[lang].filterFavoritesLabel;
document.querySelector("th:nth-child(1)").textContent = texts[lang].tableHeaders.favorites;
document.querySelector("th:nth-child(2)").textContent = texts[lang].tableHeaders.programma;
document.querySelector("th:nth-child(3)").textContent = texts[lang].tableHeaders.os;
document.querySelector("th:nth-child(4)").textContent = texts[lang].tableHeaders.statoprogramma;
document.querySelector("th:nth-child(5)").textContent = texts[lang].tableHeaders.linkprogramma;
document.querySelector("th:nth-child(6)").textContent = texts[lang].tableHeaders.dataaggiornamento;
document.querySelector("th:nth-child(7)").textContent = texts[lang].tableHeaders.videospiegativo;
}

// Impostazione della lingua iniziale
function setInitialLanguage() {
  const savedLanguage = localStorage.getItem("language") || "it";
  languageSwitch.checked = savedLanguage === "en";
  toggleLanguage();
}

languageSwitch.addEventListener("change", toggleLanguage);
setInitialLanguage();
function toggleDropdown(id) {
  var dropdown = document.getElementById(id);
  var button = dropdown.previousElementSibling;

  // Cambia la visibilit√† con un fade
  if (dropdown.style.display === 'none' || dropdown.style.display === '') {
    dropdown.style.display = 'block';
    setTimeout(function() {
      dropdown.style.opacity = 1;
    }, 10);
    button.innerHTML = '‚ñ≤';
  } else {
    dropdown.style.opacity = 0;
    setTimeout(function() {
      dropdown.style.display = 'none';
    }, 300); // Attendere il tempo della transizione
    button.innerHTML = '‚ñº';
  }
}
// Funzione per alternare il tema e salvarlo
function toggleTheme() {
  const currentTheme = localStorage.getItem("theme") || "dark";
  const newTheme = currentTheme === "dark" ? "light" : "dark";
  localStorage.setItem("theme", newTheme); // Salva il tema
  applyTheme(newTheme); // Applica il tema
}

// Applica il tema al caricamento della pagina
window.onload = function () {
  const savedTheme = localStorage.getItem("theme") || "dark"; // Imposta tema di default
  applyTheme(savedTheme); // Applica il tema salvato
  loadModsFromJson(); // Carica i dati della tabella
};

window.addEventListener("scroll", function () {
  const scrollToTopButton = document.getElementById("scrollToTop");
  if (window.scrollY > 300) {
    scrollToTopButton.style.display = "block";
  } else {
    scrollToTopButton.style.display = "none";
  }
});

// Gestione dell'evento beforeunload per svuotare sessionStorage
window.addEventListener('beforeunload', () => {
  // Cancella tutti i mod link salvati in sessionStorage quando la pagina viene chiusa o ricaricata
  Object.keys(sessionStorage)
    .filter(key => key !== 'favorites') // Esclude eventualmente altre chiavi (come i preferiti)
    .forEach(key => sessionStorage.removeItem(key)); 
});

  // Scroll fluido verso l'alto
  document.getElementById("scrollToTop").addEventListener("click", function (e) {
    e.preventDefault();
    window.scrollTo({ top: 0, behavior: "smooth" });
  });

  themeSwitch.addEventListener("change", toggleTheme);
  setInitialTheme();
  </script>
  <a href="#top" class="scroll-to-top" id="scrollToTop" title="Torna in alto">&#x25B2;</a>
</body>
</html>
