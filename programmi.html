<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tabella - Programmi</title>
  <link rel="icon" type="image/png" href="Immagini/plumboblogo.png">
  <style>
    :root {
          --navbarbackground: #343a40;
          --navbarcolor: #fff;
          --formcontainerbackground: #343a40;
          --formcontainercolor: #fff;
          --h1backgroundcolor: #343a40;
          --h1color: white;
          --thchildcolor: #666666;
          --tdcolor: #555555;
          --thcolor: white;
          --bodybackground: #343a40;
          --sconosciutavar: #545454;
          --thtdcolor: white;
          --tdacolor: #B57EDC;
          --tdahover: #FFB6C1;
          --tdactive: #8E44AD; 
        }
    
        #filter-status-dropdown, #filter-translation-dropdown, #filter-category-dropdown {
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    td a {
  color: var(--tdacolor);
}

td a:visited {
  color: var(--tdacolor);
}

td a:hover {
  color: var(--tdahover);
}

td a:active {
  color: var(--tdactive);
}
        .navbar {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-around;
      align-items: center;
      background-color: var(--navbarbackground);
      padding: 10px;
      border-bottom: 3px solid #f9359d; /* Bordo inferiore della navbar */
    }
    
    .navbar a, .navbar button {
      color: var(--navbarcolor);
      text-decoration: none;
      background-color: #4CAF50; /* Usa il colore di sfondo dal nuovo design */
      padding: 10px 20px; /* Pi√π spazio cliccabile */
      border-radius: 5px; /* Raggio bordi pi√π ampio */
      border: none;
      margin: 5px;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.2s ease;
      font-size: 16px; /* Font pi√π grande */
      text-align: center; /* Per centrare il testo */
      font-weight: bold;
    }
    
    .navbar a:hover, .navbar button:hover {
      background-color: #0f7041; /* Colore hover pi√π intenso */
      transform: scale(1.05); /* Leggero ingrandimento al passaggio del mouse */
    }
.sort-arrow {
  margin-left: 5px;
  font-size: 20px;
  color: var(--h1color);
}
    
    .sort-arrow.asc:before {
      content: "‚Üë"; /* Freccia su per l'ordinamento ascendente */
    }
    
    .sort-arrow.desc:before {
      content: "‚Üì"; /* Freccia gi√π per l'ordinamento discendente */
    }
          .scroll-to-top {
      position: fixed;
      bottom: 20px;
      right: 20px;
      display: none; /* Sar√† visibile solo quando necessario */
      width: 50px;
      height: 50px;
      background-color: #f05454;
      color: white;
      text-align: center;
      line-height: 50px;
      font-size: 24px;
      font-weight: bold;
      border-radius: 50%;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      cursor: pointer;
      transition: opacity 0.3s, transform 0.3s;
      z-index: 1000;
    }
    
    .scroll-to-top:hover {
      background-color: #d94343; /* Colore pi√π scuro al passaggio del mouse */
      transform: scale(1.1); /* Leggera animazione di ingrandimento */
    }
    
    .scroll-to-top:active {
      transform: scale(0.95); /* Riduce leggermente le dimensioni al clic */
    }
       .back-arrow {
      position: absolute;
      top: 10px;
      left: 10px;
      text-decoration: none;
      font-size: 20px;
      color: #16ab63;
      font-weight: bold;
      transition: color 0.3s ease, transform 0.2s ease;
      display: flex;
  align-items: center;
  text-decoration: none;
    }

    .back-arrow:hover {
      color: #16ab63;
      transform: scale(1.1);
    }
          
        body {
          font-family: Arial, sans-serif;
          background-color: var(--bodybackground);
          margin: 0;
          padding: 0;
        }
        
        input, select {
          margin: 10px 5px;
          padding: 10px;
          border-radius: 25px;
          border: 1px solid #ccc;
          font-size: 16px;
        }
    
        input:focus, select:focus {
          outline: none;
          border-color: #16ab63;
        }
    
        .form-container {
          display: flex;
          flex-wrap: wrap;
          justify-content: flex-start;
          align-items: center;
          margin-top: 0px; /* Riduci lo spazio sopra */
          margin-bottom: 0px; /* Riduci lo spazio sotto */
          padding: 5px;
          border: 1px solid var(--formcontainerbackground);
          border-radius: 5px;
          background-color: var(--formcontainerbackground);
          color: var(--formcontainercolor);
          gap: 60px;
        }
    
        .form-container label {
          margin-right: 10px;
          font-size: 16px;
        }
    
        input, select {
          margin: 5px;
        }
    
        .button-container {
          display: flex;
          flex-wrap: wrap;
          justify-content: center;
          gap: 10px;
        }
    
        h1 {
          color: var(--h1color);
          font-size: 2rem;
          margin: 0;
          padding: 20px 0;
          background-color: var(--h1backgroundcolor);
          text-align: center;
        }
    
        table {
          width: 100%;
          border-collapse: separate;
          border-spacing: 0;
          margin-top: 20px;
          border-radius: 10px;
          overflow: hidden;
          table-layout: auto;
        }
    
        th, td {
          padding: 15px 20px;
          text-align: center;
          border: 1px solid #ddd;
          font-size: 16px;
          word-wrap: break-word;
          color: var(--thtdcolor)
        }
    
        th {
          background-color: #4CAF50;
          color: var(--thcolor);
        }
    
        td {
          background-color: var(--tdcolor);
        }
    
        tr:nth-child(even) td {
          background-color: var(--thchildcolor);
        }
    
        .status {
          font-weight: bold;
          padding: 5px;
          border-radius: 5px;
          display: inline-block;
          width: auto;
          height: auto;
          text-transform: uppercase;
          color: white;
        }
          
        .status.nuovo {
          color: #9372ff;
        }
          
        .status.compatibile {
          color: #008eff;
        }
    
        .status.rotto {
          color: #ff0015;
        }
        
        .status.sconosciuto {
          color: var(--sconosciutavar);
        }
    
        .status.non-disponibile {
          color: lightgrey;
        }
    
        .status.aggiornato {
          color: #00d517;
        }
     /* Stile per il popup */
     .popup {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: var(--navbarbackground);
    color: var(--navbarcolor);
    padding: 20px;
    box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.3);
    border-radius: 10px;
    z-index: 1000;
    text-align: center;
}

.popup-content button {
    margin: 10px;
    padding: 10px;
    border: none;
    cursor: pointer;
}

#download-btn {
    background: #28a745;
    color: white;
}

#close-btn {
    background: #dc3545;
    color: white;
}  
        @media (max-width: 600px) {
          h1 {
            font-size: 1.5rem;
            padding: 10px;
          }
    
          .navbar a, .navbar button {
            font-size: 14px;
            padding: 10px;
            width: 100%;
          }
    
          .form-container {
            flex-direction: column;
            align-items: flex-start;
          }
        }
    
        .star-container {
          display: flex;
          justify-content: center;
          align-items: center;
          width: 100%;
          height: 100%;
        }
    
        .star {
          font-size: 24px;
          cursor: pointer;
          color: grey;
          transition: transform 0.2s;
        }
    
        .star.favorite {
          color: gold;
        }
    
        .star:hover {
          transform: scale(1.2);
        }
      </style>
</head>
<body>
  <a href="index.html" class="back-arrow">
    <img src="Immagini/plumboblogonoscritte.png" alt="Home Logo" width="50" height="auto">
    <span class="home-text">HOME</span>
  </a>
  <h1>Tabella - Programmi</h1>
  <div class="navbar">
    <a href="mod.html">MOD</a>
    <a href="mod18.html">MOD +18</a>
    <a href="animazioniww18.html">ANIMAZIONI WICKED WHIMS +18</a>
    <a href="traduzioni.html">TRADUZIONI</a>
    <a href="programmi.html">PROGRAMMI</a>
    <a href="#" id="desc-mod-btn">HELP SIM</a>
    <button id="themeSwitch" onclick="toggleTheme()" class="theme-toggle" title="Cambia Tema">üåô</button>
  </div>
  <div id="popup" class="popup">
    <div class="popup-content">
        <h2>üöÄ HELP SIM</h2>
        <p>
          Stanco di installare mod e traduzioni a mano? Help Sim √® qui per salvarti! 
          Con pochi click, potrai aggiungere le tue mod preferite, tenere tutto sotto controllo e persino dare una bella ripulita ai file cache di The Sims 4!
          Che tu voglia ampliare il tuo gioco con nuove mod o semplicemente tenere tutto in ordine, sei nel posto giusto.
        </p>
        
        <p>Ora rilassati, personalizza il tuo gioco e lascia che <strong>Help Sim</strong> faccia il resto! üéÆ‚ú®</p>
        
        <hr>
  
        <h3>‚ö†Ô∏è PICCOLE ATTENZIONI PRIMA DELLO SCARICO ‚ö†Ô∏è</h3>
        <ul style="list-style-type: none; padding-left: 0;">
            <li>‚òÖ Se l‚Äôantivirus blocca il programma, clicca su <strong>"Esegui comunque"</strong>.<br>
                Il programma √® sicuro! In quanto creato interamente da noi.</li>
            <li>‚òÖ Prima dell‚Äôuso, <strong>leggi la guida</strong> disponibile nella home del programma.</li>
            <li>‚òÖ Supporta solo i file delle mod e delle traduzioni in <strong>formato ZIP</strong>.</li>
            <li>‚òÖ <strong>Non supporta</strong> i file singoli <em>.package</em> (CC e mod non zip).</li>
            <li>‚òÖ <strong>Non funziona</strong> con la cartella di The Sims in unit√† esterne (HDD, SSD, USB, ecc.).</li>
        </ul>
  
        <div class="popup-buttons">
            <button id="download-btn">üì• Scarica</button>
            <button id="close-btn">‚ùå Chiudi</button>
        </div>
    </div>
  </div>
  <div class="form-container">
    <div>
      <input type="text" id="search" oninput="filterTable()" placeholder="Cerca...">
    </div>
    <div>
      <label for="filter-status">Stato:</label>
      <button onclick="toggleDropdown('filter-status-dropdown')">‚ñº</button>
      <div id="filter-status-dropdown" style="display:none;">
        <label><input type="checkbox" value="Compatibile" id="status-compatibile" onchange="filterTable()"> Compatibile</label><br>
        <label><input type="checkbox" value="Rotta" id="status-rotta" onchange="filterTable()"> Rotta</label><br>
        <label><input type="checkbox" value="Aggiornata" id="status-aggiornata" onchange="filterTable()"> Aggiornata</label><br>
        <label><input type="checkbox" value="Sconosciuta" id="status-sconosciuta" onchange="filterTable()"> Sconosciuta</label><br>
        <label><input type="checkbox" value="Nuova" id="status-nuova" onchange="filterTable()"> Nuova</label>
        <label><input type="checkbox" value="Non Disponibile" id="status-non-disponibile" onchange="filterTable()"> Nuova</label>
      </div>
    </div>
    <div>
      <label for="filter-favorites">Preferiti:</label>
      <select id="filter-favorites" onchange="filterTable()">
        <option value="">Tutti</option>
        <option value="true">Preferiti</option>
        <option value="false">Non preferiti</option>
      </select>
    </div>
</div>
<table id="programmi-table">
  <thead>
      <tr>
          <th rowspan="2">PREFERITE <span class="sort-arrow" id="arrow-0"></span></th>
          <th rowspan="2">PROGRAMMA <span class="sort-arrow" id="arrow-1"></span></th>
          <th colspan="2">S.O. <span class="sort-arrow" id="arrow-2"></span></th> <!-- Merged column for S.O. -->
          <th colspan="2">STATO PROGRAMMA <span class="sort-arrow" id="arrow-3"></span></th> <!-- Stato per S.O. -->
          <th rowspan="2">LINK PROGRAMMA <span class="sort-arrow" id="arrow-4"></span></th>
          <th rowspan="2">DATA AGGIORNAMENTO <span class="sort-arrow" id="arrow-5"></span></th>
          <th rowspan="2">VIDEO SPIEGATIVO <span class="sort-arrow" id="arrow-6"></span></th>
      </tr>
      <tr>
          <!-- La seconda riga rimane vuota per le celle che sono gi√† unite nella prima -->
          <th>Windows</th> <!-- Header for Windows -->
          <th>macOS</th> <!-- Header for macOS -->
          <th>Windows</th> <!-- Stato per Windows -->
          <th>macOS</th> <!-- Stato per macOS -->
      </tr>
  </thead>
  <tbody>
      <!-- Le righe verranno caricate dinamicamente dal JSON -->
  </tbody>
</table>
  <script>
        document.getElementById("desc-mod-btn").addEventListener("click", function(event) {
    event.preventDefault();
    document.getElementById("popup").style.display = "block";
});

document.getElementById("close-btn").addEventListener("click", function() {
    document.getElementById("popup").style.display = "none";
});

document.getElementById("download-btn").addEventListener("click", function() {
    const link = document.createElement("a");
    link.href = "https://github.com/PianetaSimTS/HelpSim/releases/download/HelpSim/HelpSim.exe";
    link.download = "HelpSim.exe";
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    document.getElementById("popup").style.display = "none"; // Chiude il popup dopo il download
});
function loadModsFromJson() {
  fetch('https://raw.githubusercontent.com/PianetaSimTS/PianetaSim/refs/heads/main/Json/programmi.json')
    .then(response => response.json())
    .then(mods => {
      const favorites = JSON.parse(localStorage.getItem("favorites")) || [];
      const table = document.getElementById("programmi-table").getElementsByTagName("tbody")[0];
      table.innerHTML = '';

      // Crea righe per ogni mod
      mods.forEach(mod => {
        const isFavorite = favorites.includes(mod.programma);
        const checkWindows = mod.windows ? '‚úî' : '‚ùå';
        const checkMacOS = mod.macos ? '‚úî' : '‚ùå';
        const statusWindows = mod.statuswindows || 'Sconosciuto'; // Cambiato 'sconosciuto' in maiuscolo
        const statusMacOS = mod.statusmacos || 'Sconosciuto'; // Cambiato 'sconosciuto' in maiuscolo

        const newRow = table.insertRow();
        newRow.innerHTML = `
          <td>
            <span class="star-container">
              <span class="star ${isFavorite ? 'favorite' : ''}" onclick="toggleFavorite('${mod.programma}')">&#9733;</span>
            </span>
          </td>
          <td>${mod.programma || ''}</td>
          <td>${checkWindows}</td> <!-- Compatibilit√† con Windows -->
          <td>${checkMacOS}</td> <!-- Compatibilit√† con macOS -->
          <td><span class="status ${statusWindows.toLowerCase().replace(/\s+/g, '-')}"">${statusWindows}</span></td> <!-- Stato Windows -->
          <td><span class="status ${statusMacOS.toLowerCase().replace(/\s+/g, '-')}"">${statusMacOS}</span></td> <!-- Stato macOS -->
          <td><a href="${mod.link_programma || '#'}" target="_blank">Link</a></td>
          <td>${mod.data_aggiornamento || ''}</td>
          <td><a href="${mod.video_spiegativo || '#'}" target="_blank">Video</a></td>
        `;
      });

      filterTable();
    })
    .catch(error => console.error('Errore nel caricare il JSON:', error));
}
    let lastSortedColumn = -1; // Memorizza l'ultima colonna ordinata
    let lastSortDirection = 'asc'; // Ordine di ordinamento: ascendente (default) o discendente

    function sortTable(columnIndex) {
      const table = document.getElementById("programmi-table");
      const rows = Array.from(table.rows).slice(1); // Esclude l'intestazione
      const arrow = document.getElementById(`arrow-${columnIndex}`);

      if (lastSortedColumn === columnIndex) {
        lastSortDirection = (lastSortDirection === 'asc') ? 'desc' : 'asc';
      } else {
        lastSortDirection = 'asc';
      }

      const compare = (a, b) => {
        let valA = a.cells[columnIndex].textContent.trim().toLowerCase();
        let valB = b.cells[columnIndex].textContent.trim().toLowerCase();

        if (valA < valB) return lastSortDirection === 'asc' ? -1 : 1;
        if (valA > valB) return lastSortDirection === 'asc' ? 1 : -1;
        return 0;
      };

      rows.sort(compare);
      rows.forEach(row => table.appendChild(row));

      document.querySelectorAll('.sort-arrow').forEach(arrow => arrow.className = 'sort-arrow');
      arrow.classList.add(lastSortDirection);

      lastSortedColumn = columnIndex;
    }

    function filterTable() {
  const searchValue = document.getElementById("search").value.toLowerCase();
  
  // Stato - raccogli i valori selezionati
  const selectedStatuses = Array.from(document.querySelectorAll('#filter-status-dropdown input:checked'))
                                  .map(input => input.value.toLowerCase());
  
  const filterFavorites = document.getElementById("filter-favorites").value.toLowerCase();

  const table = document.getElementById("programmi-table");
  const rows = table.getElementsByTagName("tr");

  for (let i = 1; i < rows.length; i++) {
        const row = rows[i];
        const author = row.cells[1].textContent.toLowerCase();
        
        // Controllo che esista un elemento con classe .status
        const statusElement = row.querySelector(".status");
        const status = statusElement ? statusElement.textContent.toLowerCase() : ''; // Imposta una stringa vuota se non esiste
        
        // Controllo che esista un elemento con classe .star
        const starElement = row.querySelector(".star");
        const isFavorite = starElement && starElement.classList.contains("favorite"); // Verifica se .star esiste prima
        
        const matchesStatus = selectedStatuses.length === 0 || selectedStatuses.includes(status);
        const matchesSearch = author.includes(searchValue);
        const matchesFavorites = !filterFavorites || (filterFavorites === 'true' ? isFavorite : !isFavorite);
        
        row.style.display = (matchesSearch && matchesStatus && matchesFavorites) ? "" : "none";
  }
}
    function toggleFavorite(author) {
  // Remove the apostrophe when toggling favorites
  const cleanedAuthor = author.replace("'", "");
  let favorites = JSON.parse(localStorage.getItem("favorites")) || [];
  
  if (favorites.includes(cleanedAuthor)) {
    favorites = favorites.filter(favorite => favorite !== cleanedAuthor);
    alert(author + " √® stato rimosso dai preferiti.");
  } else {
    favorites.push(cleanedAuthor);
    alert(author + " √® stato aggiunto ai preferiti!");
  }
  
  localStorage.setItem("favorites", JSON.stringify(favorites));
  loadModsFromJson();
}
    window.onload = loadModsFromJson;

    function applyTheme(theme) {
  const root = document.documentElement;
  const themeSwitch = document.getElementById("themeSwitch");
  
  if (theme === "light") {
    root.style.setProperty("--navbarbackground", "#ffffff"); // Grigio molto chiaro per la navbar
root.style.setProperty("--navbarcolor", "#000000"); // Testo scuro per la navbar
root.style.setProperty("--formcontainerbackground", "#ffffff"); // Bianco per lo sfondo del contenitore
root.style.setProperty("--formcontainercolor", "#black"); // Testo scuro nel contenitore
root.style.setProperty("--h1backgroundcolor", "#ffffff"); // Grigio chiaro per sfondo h1
root.style.setProperty("--h1color", "#black"); // Testo scuro per h1
root.style.setProperty("--thchildcolor", "#f2f2f2"); // Grigio medio per i titoli delle colonne
root.style.setProperty("--tdcolor", "#f9f9f9"); // Grigio medio-scuro per il testo nelle celle
root.style.setProperty("--thcolor", "#000000"); // Testo scuro per i titoli delle colonne
root.style.setProperty("--bodybackground", "#ffffff"); // Sfondo bianco per il corpo
root.style.setProperty("--sconosciutavar", "#545454"); // Giallo brillante per mantenere un colore vivace
root.style.setProperty("--thtdcolor", "black");
root.style.setProperty("--tdacolor", "blue");
root.style.setProperty("--tdahover", "#551A8B");
root.style.setProperty("--tdactive", "#000080");    
    themeSwitch.textContent = "üåû";
  } else {
    // Passa al tema scuro
    root.style.setProperty("--navbarbackground", "#343a40");
    root.style.setProperty("--navbarcolor", "#fff");
    root.style.setProperty("--formcontainerbackground", "#343a40");
    root.style.setProperty("--formcontainercolor", "#fff");
    root.style.setProperty("--h1backgroundcolor", "#343a40");
    root.style.setProperty("--h1color", "white");
    root.style.setProperty("--thchildcolor", "#666666");
    root.style.setProperty("--tdcolor", "#555555");
    root.style.setProperty("--thcolor", "white");
    root.style.setProperty("--bodybackground", "#343a40");
    root.style.setProperty("--sconosciutavar", "#FFFBB9");
    root.style.setProperty("--thtdcolor", "white");
    root.style.setProperty("--tdacolor", "#B57EDC");
    root.style.setProperty("--tdahover", "#FFB6C1");
    root.style.setProperty("--tdactive", "#8E44AD");
    themeSwitch.textContent = "üåô";
  }
}
function toggleDropdown(id) {
  var dropdown = document.getElementById(id);
  var button = dropdown.previousElementSibling;

  // Cambia la visibilit√† con un fade
  if (dropdown.style.display === 'none' || dropdown.style.display === '') {
    dropdown.style.display = 'block';
    setTimeout(function() {
      dropdown.style.opacity = 1;
    }, 10);
    button.innerHTML = '‚ñ≤';
  } else {
    dropdown.style.opacity = 0;
    setTimeout(function() {
      dropdown.style.display = 'none';
    }, 300); // Attendere il tempo della transizione
    button.innerHTML = '‚ñº';
  }
}
// Funzione per alternare il tema e salvarlo
function toggleTheme() {
  const currentTheme = localStorage.getItem("theme") || "dark";
  const newTheme = currentTheme === "dark" ? "light" : "dark";
  localStorage.setItem("theme", newTheme); // Salva il tema
  applyTheme(newTheme); // Applica il tema
}

// Applica il tema al caricamento della pagina
window.onload = function () {
  const savedTheme = localStorage.getItem("theme") || "dark"; // Imposta tema di default
  applyTheme(savedTheme); // Applica il tema salvato
  loadModsFromJson(); // Carica i dati della tabella
};

window.addEventListener("scroll", function () {
  const scrollToTopButton = document.getElementById("scrollToTop");
  if (window.scrollY > 300) {
    scrollToTopButton.style.display = "block";
  } else {
    scrollToTopButton.style.display = "none";
  }
});

// Gestione dell'evento beforeunload per svuotare sessionStorage
window.addEventListener('beforeunload', () => {
  // Cancella tutti i mod link salvati in sessionStorage quando la pagina viene chiusa o ricaricata
  Object.keys(sessionStorage)
    .filter(key => key !== 'favorites') // Esclude eventualmente altre chiavi (come i preferiti)
    .forEach(key => sessionStorage.removeItem(key)); 
});

  // Scroll fluido verso l'alto
  document.getElementById("scrollToTop").addEventListener("click", function (e) {
    e.preventDefault();
    window.scrollTo({ top: 0, behavior: "smooth" });
  });

  themeSwitch.addEventListener("change", toggleTheme);
  setInitialTheme();
  </script>
  <a href="#top" class="scroll-to-top" id="scrollToTop" title="Torna in alto">&#x25B2;</a>
</body>
</html>

